# S23 风险日志

> 最后更新: 2025-12-29

本文档记录项目的 10 大风险及其缓解措施执行情况。

## 风险矩阵

| ID | 风险 | 严重度 | 概率 | 状态 | 缓解措施 |
|----|------|--------|------|------|----------|
| R1 | 过拟合/捷径学习 | 高 | 中 | ✅ 已缓解 | 负对照验证 (S7) |
| R2 | 辅助头作弊 | 高 | 低 | ✅ 已缓解 | CTC 与音频损失独立验证 |
| R3 | GPU 资源/OOM | 中 | 中 | ✅ 已缓解 | 动态批次 + 梯度累积 |
| R4 | 训练不稳定 | 中 | 中 | ✅ 已缓解 | 梯度裁剪 + 学习率预热 |
| R5 | 模型容量不足 | 中 | 低 | ✅ 已缓解 | 12 层架构验证 |
| R6 | 多任务干扰 | 高 | 中 | ✅ 已缓解 | Subject-Selector + 课程学习 |
| R7 | 评分器偏差 | 高 | 低 | ✅ 已缓解 | FFT 解码 + 负对照验证 |
| R8 | 进度延误 | 中 | 中 | ✅ 已缓解 | 周计划 + 里程碑跟踪 |
| R9 | SSM 实现问题 | 中 | 低 | ✅ 已缓解 | 降级到卷积替代 |
| R10 | 音频质量不足 | 低 | 低 | ⚠️ 待观察 | STFT 多分辨率损失 |

## 详细说明

### R1: 过拟合/捷径学习

**描述**: 模型可能学习数据集特有的捷径而非真正的任务逻辑。

**缓解措施**:
- [x] 实现 S7 负对照套件 (label_shuffle, phase_scramble, random_mapping)
- [x] 所有 12 个负对照测试通过
- [x] 多步 mod_compose 任务也被负对照击穿

**验证结果**: `reports/negative_controls.md`

---

### R2: 辅助头作弊

**描述**: CTC 辅助头可能通过某种方式"泄露"正确答案给解码器。

**缓解措施**:
- [x] CTC 损失与音频重建损失独立计算
- [x] 消融实验验证 no_ctc 配置
- [x] Oracle baseline 验证评分器正确性

---

### R3: GPU 资源/OOM

**描述**: 长序列或大批次可能导致显存溢出。

**缓解措施**:
- [x] 动态批次大小配置
- [x] 梯度累积支持
- [x] 单 GPU 训练验证通过

---

### R4: 训练不稳定

**描述**: 梯度爆炸或损失震荡导致训练失败。

**缓解措施**:
- [x] 梯度裁剪 (grad_clip=1.0)
- [x] 学习率预热 (warmup epochs)
- [x] 损失权重调度

---

### R5: 模型容量不足

**描述**: Mini-JMamba 架构可能不足以处理复杂任务。

**缓解措施**:
- [x] 10 SSM + 2 Attention 架构
- [x] Task3 多步组合验证通过
- [x] OOD 泛化验证通过

---

### R6: 多任务干扰

**描述**: 同时训练多任务可能导致遗忘或干扰。

**缓解措施**:
- [x] Subject-Selector 采样策略
- [x] 课程学习（预训练阶段）
- [x] 任务特定损失权重

---

### R7: 评分器偏差

**描述**: FFT 解码器可能引入系统性偏差。

**缓解措施**:
- [x] 负对照验证评分器不走捷径
- [x] Oracle baseline EM=1.0
- [x] 相位扰动测试验证 FFT 正确性

---

### R8: 进度延误

**描述**: 项目可能无法按周计划完成。

**缓解措施**:
- [x] 周计划文档 (docs/sprint_week5_8.md)
- [x] 里程碑跟踪 (docs/milestone_log.md)
- [x] 每日进度更新

---

### R9: SSM 实现问题

**描述**: Mamba-2 SSM 可能在某些环境下不可用。

**缓解措施**:
- [x] 降级到卷积替代实现
- [x] 自动检测 mamba_ssm 可用性
- [x] 测试覆盖两种实现

---

### R10: 音频质量不足

**描述**: 生成的音频可能不够清晰或有噪声。

**缓解措施**:
- [x] 多分辨率 STFT 损失
- [x] 时域 L1 损失
- [ ] 高频能量惩罚（待实现）

**状态**: 待观察，当前音频质量满足评测需求

---

## 更新记录

| 日期 | 更新内容 |
|------|----------|
| 2025-12-29 | 初始版本，10 大风险已识别并缓解 |
